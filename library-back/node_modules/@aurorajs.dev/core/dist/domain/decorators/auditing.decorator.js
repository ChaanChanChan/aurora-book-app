"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.Auditing = void 0;
const common_1 = require("@nestjs/common");
const graphql_1 = require("@nestjs/graphql");
exports.Auditing = (0, common_1.createParamDecorator)((data = {
    accountContainer: 'user',
}, context) => {
    let request;
    if (context['contextType'] === 'graphql') {
        const ctx = graphql_1.GqlExecutionContext.create(context);
        request = ctx.getContext().req;
    }
    else if (context['contextType'] === 'http') {
        request = context.switchToHttp().getRequest();
    }
    return {
        ip: request.ip,
        method: request.method,
        baseUrl: request.baseUrl,
        userAgent: request.get('user-agent'),
        params: request.params,
        query: request.query,
        body: request.body,
        account: request[data.accountContainer],
    };
});
